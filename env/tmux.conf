# use 256 color
setw -g xterm-keys on
set -g default-terminal "screen-256color"

# remap prefix to Control + a
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# force a reload of the config file
unbind r
bind r source-file ~/.tmux.conf \; display-message "Config reloaded..."

# quick pane cycling
set -g mouse on
set -g terminal-overrides 'xterm*:smcup@:rmcup@'

# act like vim - requires ctrl+A+(h|j|k|l) to switch panes
setw -g mode-keys vi
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
bind-key -t vi-copy 'v' begin-selection
bind-key -t vi-copy 'y' copy-selection

# clock
set-window-option -g clock-mode-colour green #green

# fixes issue when switching between panes and getting history when pressing up
bind-key Up    select-pane -U
bind-key Down  select-pane -D
bind-key Left  select-pane -L
bind-key Right select-pane -R

# Shift arrow to switch windows
bind -n S-Left  previous-window
bind -n S-Right next-window

# start window numbering at 1 for easier switching
set -g base-index 1

# Clear the current pane AND clear the pane's history
#bind -n C-k send-keys "clear && tmux clear-history" \; send-keys "Enter"

# Set window notifications
setw -g monitor-activity on
set -g visual-activity on


# set pane colors - hilight the active pane
set-option -g pane-border-fg colour235 #base02
set-option -g pane-active-border-fg colour33 #blue
set-option -g pane-active-border-fg colour240 #base01

# colorize messages in the command line
set-option -g message-bg black #base02
set-option -g message-fg brightred #orange

# ----------------------
# Status Bar
# -----------------------
set -g status-utf8 on                  # set utf-8 for the status bar
set -g status-interval 5               # set update frequencey (default 15 seconds)
set -g status-justify centre           # center window list for clarity
set -g status-left-length 300
set -g status-right-length 300

# show host name and IP address on left side of status bar
set -g status-left "#[fg=green] #h | #[fg=brightblue]#(curl icanhazip.com) #[fg=yellow]#(ifconfig en1 | grep 'inet ' | awk '{print \"en0 \" $2}') #[fg=red]#(ifconfig tun0 | grep 'inet ' | awk '{print \"vpn \" $2}') #[fg=green]#(/System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport -I | awk -F': ' '/ SSID/{print $2}') "

# Show host, load averages, and an indicator for the prefix key
# set -g status-left "#[fg=green]: #h : #[fg=brightblue]#(uptime | rev | cut -d ' ' -f 1-3 | rev) #{?client_prefix,#[fg=colour2]^A,} "

# show session name, window & pane number, date and time on right side of
# status bar
set -g status-right "#[fg=cyan]#{=15:pane_title} | #[fg=blue]#S #I:#P #[fg=yellow]| %d %b %Y #[fg=green]| %H:%M (EST) | #(date -u | awk '{print $4}') (UTC) | #[fg=colour240]#{battery_percentage} "


# Be as large as you can be
setw -g aggressive-resize on

# Fix tmux copy bug
set-option -g default-command "reattach-to-user-namespace -l zsh"

# change the escape time in tmux to zero
set-option -sg escape-time 0

set -g status-position bottom
set -g pane-border-fg colour237
set -g pane-active-border-fg colour237

# show the tmux status bar
set -g status on

# auto rename windows
set -g automatic-rename on

# use a large scrollback history
set-option -g history-limit 10000

# Colorize the messages in the command
set-option -g message-bg colour235
set-option -g message-fg red

# Sane colors for a light background
set -g status-bg colour8
set -g status-fg colour1
set-window-option -g window-status-current-fg colour15

# https://superuser.com/questions/834525/unable-to-launch-application-in-tmux
set-option -g default-command "reattach-to-user-namespace -l zsh"

bind-key S run-shell "tmux rename-session $(basename $(pwd))"

# use old behavior for splits and new windows
unbind '"'
unbind '%'
unbind 'c'

bind-key '"' split-window -c "#{pane_current_path}"
bind-key '%' split-window -h -c "#{pane_current_path}"
bind-key 'c' new-window -c "#{pane_current_path}"


# List of plugins
# Supports `github_username/repo` or full git URLs
set -g @tpm_plugins "              \
  tmux-plugins/tpm                       \
  tmux-plugins/tmux-copycat              \
  tmux-plugins/tmux-battery-osx          \
  tmux-plugins/tmux-sessionist           \
"

# initializes TMUX plugin manager
run-shell ~/.tmux/plugins/tpm/tpm

# copy to clipboard buffer
bind -t vi-copy y copy-pipe "reattach-to-user-namespace pbcopy"

